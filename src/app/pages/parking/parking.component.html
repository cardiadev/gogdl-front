<div class="parking-layout">
  <div class="content-area">
    <div class="parking-container">
      <h1>{{ "PARKING.TITLE" | translate }}</h1>

      <!-- Filter Chips -->
      <div class="filter-section">
        <div class="filter-chips">
          @for (filter of filterOptions; track filter.id) {
            <button
              class="filter-chip"
              [class.active]="filter.isActive"
              (click)="selectFilter(filter.id)">
              <mat-icon>{{ filter.icon }}</mat-icon>
              <span>{{ filter.labelKey | translate }}</span>
            </button>
          }
        </div>
      </div>

      <!-- Loading State -->
      @if (isLoading) {
        <div class="loading-section">
          <div class="loading-container">
            <div class="loading-spinner"></div>
            <p>{{ "PARKING.LOADING_IMAGES" | translate }}</p>
          </div>
        </div>
      }

      <!-- Content when loaded -->
      @if (!isLoading) {
        <!-- Nearby Section -->
        <div class="section">
          <div class="section-header">
            <h2>{{ "PARKING.NEARBY" | translate }}</h2>
            <div class="header-controls">
              <span class="section-count">{{ nearbyParkingLots().length }}</span>
              <button
                class="view-toggle-btn"
                (click)="onToggleViewMode()"
                [title]="currentViewMode() === 'cards' ? ('PARKING.VIEW.LIST' | translate) : ('PARKING.VIEW.CARDS' | translate)">
                <mat-icon>{{ currentViewMode() === 'cards' ? 'view_list' : 'view_module' }}</mat-icon>
              </button>
            </div>
          </div>

          <div class="carousel-container"
               [class.list-view]="currentViewMode() === 'list'"
               [attr.data-view-mode]="currentViewMode()">
            <div class="carousel"
                 [class.list-layout]="currentViewMode() === 'list'">
              @for (parkingLot of nearbyParkingLots(); track parkingLot.id) {
                <app-parking-card
                  [parkingLot]="parkingLot"
                  [viewMode]="currentViewMode()"
                  [attr.data-view]="currentViewMode()"
                  (onDirections)="onDirections($event)"
                  (onShare)="onShare($event)"
                  (onToggleFavorite)="onToggleFavorite($event)">
                </app-parking-card>
              }
            </div>
          </div>
        </div>

        <!-- Favorites Section -->
        @if (favoriteParkingLots().length > 0) {
          <div class="section">
            <div class="section-header">
              <h2>{{ "PARKING.FAVORITES" | translate }}</h2>
              <div class="header-controls">
                <span class="section-count">{{ favoriteParkingLots().length }}</span>
                <button
                  class="view-toggle-btn"
                  (click)="onToggleViewMode()"
                  [title]="currentViewMode() === 'cards' ? ('PARKING.VIEW.LIST' | translate) : ('PARKING.VIEW.CARDS' | translate)">
                  <mat-icon>{{ currentViewMode() === 'cards' ? 'view_list' : 'view_module' }}</mat-icon>
                </button>
              </div>
            </div>

            <div class="carousel-container"
                 [class.list-view]="currentViewMode() === 'list'"
                 [attr.data-view-mode]="currentViewMode()">
              <div class="carousel"
                   [class.list-layout]="currentViewMode() === 'list'">
                @for (favoriteLot of favoriteParkingLots(); track favoriteLot.id) {
                  <app-parking-card
                    [parkingLot]="favoriteLot"
                    [viewMode]="currentViewMode()"
                    [attr.data-view]="currentViewMode()"
                    (onDirections)="onDirections($event)"
                    (onShare)="onShare($event)"
                    (onToggleFavorite)="onToggleFavorite($event)">
                  </app-parking-card>
                }
              </div>
            </div>
          </div>
        }

        <!-- Empty state for favorites -->
        @if (favoriteParkingLots().length === 0) {
          <div class="section">
            <div class="section-header">
              <h2>{{ "PARKING.FAVORITES" | translate }}</h2>
              <span class="section-count">0</span>
            </div>

            <div class="empty-state">
              <mat-icon>favorite_border</mat-icon>
              <p>{{ "PARKING.EMPTY_STATE.TITLE" | translate }}</p>
              <span>{{ "PARKING.EMPTY_STATE.MESSAGE" | translate }}</span>
            </div>
          </div>
        }
      }
    </div>
  </div>

  <div class="nav-area">
    <app-bottom-nav></app-bottom-nav>
  </div>
</div>
