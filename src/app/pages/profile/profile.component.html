<div class="profile-layout">
  <div class="profile-content">
    <div class="profile-container">
      <h1>{{ "PROFILE.TITLE" | translate }}</h1>

      <!-- Profile Image -->
      <div class="profile-image-container">
        <div class="profile-image">
          <div class="profile-placeholder">
            CJ
          </div>
        </div>
      </div>

      <!-- Profile Form -->
      <form [formGroup]="profileForm" class="profile-form">
        <!-- First Name -->
        <mat-form-field appearance="outline" class="form-field">
          <mat-label>{{ "PROFILE.FIRST_NAME" | translate }}</mat-label>
          <input
            matInput
            formControlName="firstName"
            (blur)="onFieldBlur('firstName')"
            (input)="onFieldChange()">
          <mat-error *ngIf="getFieldError('firstName')">
            {{ (getFieldError('firstName') ?? '') | translate }}
          </mat-error>
        </mat-form-field>

        <!-- Last Name -->
        <mat-form-field appearance="outline" class="form-field">
          <mat-label>{{ "PROFILE.LAST_NAME" | translate }}</mat-label>
          <input
            matInput
            formControlName="lastName"
            (blur)="onFieldBlur('lastName')"
            (input)="onFieldChange()">
          <mat-error *ngIf="getFieldError('lastName')">
            {{ (getFieldError('lastName') ?? '') | translate }}
          </mat-error>
        </mat-form-field>

        <!-- Email -->
        <mat-form-field appearance="outline" class="form-field">
          <mat-label>{{ "PROFILE.EMAIL" | translate }}</mat-label>
          <input
            matInput
            type="email"
            formControlName="email"
            (blur)="onFieldBlur('email')"
            (input)="onFieldChange()">
          <mat-error *ngIf="getFieldError('email')">
            {{ (getFieldError('email') ?? '') | translate }}
          </mat-error>
        </mat-form-field>

        <!-- Birth Date -->
        <mat-form-field appearance="outline" class="form-field">
          <mat-label>{{ "PROFILE.BIRTH_DATE" | translate }}</mat-label>
          <input
            matInput
            [matDatepicker]="picker"
            formControlName="birthDate"
            (input)="onFieldChange()"
            (dateChange)="onFieldChange()">
          <mat-datepicker-toggle matIconSuffix [for]="picker"></mat-datepicker-toggle>
          <mat-datepicker #picker></mat-datepicker>
          <mat-error *ngIf="getFieldError('birthDate')">
            {{ (getFieldError('birthDate') ?? '') | translate }}
          </mat-error>
        </mat-form-field>

        <!-- Password -->
        <mat-form-field appearance="outline" class="form-field">
          <mat-label>{{ "PROFILE.PASSWORD" | translate }}</mat-label>
          <input
            matInput
            [type]="showPassword ? 'text' : 'password'"
            formControlName="password"
            (blur)="onFieldBlur('password')"
            (input)="onFieldChange()">
          <button
            mat-icon-button
            matIconSuffix
            type="button"
            (click)="togglePasswordVisibility()"
            [attr.aria-label]="showPassword ? ('PROFILE.HIDE_PASSWORD' | translate) : ('PROFILE.SHOW_PASSWORD' | translate)"
            [attr.aria-pressed]="showPassword">
            <mat-icon>{{ showPassword ? 'visibility_off' : 'visibility' }}</mat-icon>
          </button>
          <mat-error *ngIf="getFieldError('password')">
            {{ (getFieldError('password') ?? '') | translate }}
          </mat-error>
        </mat-form-field>

        <!-- Save/Discard buttons - only show when there are unsaved changes -->
        @if (hasUnsavedChanges) {
          <div class="action-buttons">
            <button
              type="button"
              class="save-button"
              (click)="saveChanges()"
              [disabled]="!profileForm.valid">
              {{ "PROFILE.SAVE_CHANGES" | translate }}
            </button>
            <button
              type="button"
              class="discard-button"
              (click)="discardChanges()">
              {{ "PROFILE.DISCARD_CHANGES" | translate }}
            </button>
          </div>
        }

        <button type="button" class="logout-button" (click)="onLogout()">
          {{ "PROFILE.LOGOUT" | translate }}
        </button>
      </form>
    </div>
  </div>

  <div class="nav-area">
    <app-bottom-nav></app-bottom-nav>
  </div>
</div>
